<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Mini Order N∆∞·ªõc</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .qty-box {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .qty-box input {
      width: 50px;
      text-align: center;
    }
    .qty-box button {
      width: 30px;
      height: 30px;
      line-height: 1;
    }
    .note-display {
      font-size: 0.8rem;
      color: #555;
      margin-top: 5px;
      min-height: 18px;
    }
    .cart-icon {
      position: relative;
      cursor: pointer;
    }
    .cart-badge {
      position: absolute;
      top: -5px;
      right: -10px;
    }
  </style>
</head>
<body class="bg-light">

<!-- Header -->
<nav class="navbar navbar-dark bg-success mb-3">
  <div class="container-fluid">
    <span class="navbar-brand mb-0 h1">‚òï Mini Order</span>
    <div class="cart-icon" data-bs-toggle="offcanvas" data-bs-target="#cartCanvas">
      <button class="btn btn-light position-relative">
        üõí
        <span class="badge bg-danger cart-badge" id="cartCount">0</span>
      </button>
    </div>
  </div>
</nav>

<div class="container">

  <h5 class="mb-3">Ch·ªçn n∆∞·ªõc u·ªëng</h5>
  <div class="row g-2">

    <!-- Card s·∫£n ph·∫©m -->
    <div class="col-6">
      <div class="card h-100">
        <div class="card-body text-center">
          <h6 class="card-title">C√† ph√™ s·ªØa</h6>
          <p class="text-muted">25,000ƒë</p>
          <div class="note-display" id="note-display-1"></div>
          <div class="qty-box mb-2">
            <button class="btn btn-sm btn-outline-secondary btn-minus">-</button>
            <input type="number" class="form-control form-control-sm mx-1 qty-input" value="0" min="0">
            <button class="btn btn-sm btn-outline-secondary btn-plus">+</button>
          </div>
          <button class="btn btn-sm btn-outline-info w-100 mb-2 btn-note"
                  data-bs-toggle="modal"
                  data-bs-target="#noteModal"
                  data-id="1"
                  data-product="C√† ph√™ s·ªØa">
            Ghi ch√∫ m√≥n
          </button>
          <button class="btn btn-sm btn-outline-success w-100 btn-addcart"
                  data-id="1"
                  data-name="C√† ph√™ s·ªØa"
                  data-price="25000">+ Gi·ªè</button>
        </div>
      </div>
    </div>

    <!-- Card kh√°c -->
    <div class="col-6">
      <div class="card h-100">
        <div class="card-body text-center">
          <h6 class="card-title">Tr√† ƒë√†o</h6>
          <p class="text-muted">30,000ƒë</p>
          <div class="note-display" id="note-display-2"></div>
          <div class="qty-box mb-2">
            <button class="btn btn-sm btn-outline-secondary btn-minus">-</button>
            <input type="number" class="form-control form-control-sm mx-1 qty-input" value="0" min="0">
            <button class="btn btn-sm btn-outline-secondary btn-plus">+</button>
          </div>
          <button class="btn btn-sm btn-outline-info w-100 mb-2 btn-note"
                  data-bs-toggle="modal"
                  data-bs-target="#noteModal"
                  data-id="2"
                  data-product="Tr√† ƒë√†o">
            Ghi ch√∫ m√≥n
          </button>
          <button class="btn btn-sm btn-outline-success w-100 btn-addcart"
                  data-id="2"
                  data-name="Tr√† ƒë√†o"
                  data-price="30000">+ Gi·ªè</button>
        </div>
      </div>
    </div>

  </div>

</div>

<!-- Modal Ghi ch√∫ -->
<div class="modal fade" id="noteModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Ghi ch√∫ m√≥n</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="currentProductId">
        <input type="text" class="form-control mb-2" id="nameInput" placeholder="T√™n (v√≠ d·ª•: A, B...)">
        <input type="text" class="form-control mb-2" id="noteInput" placeholder="Nh·∫≠p ghi ch√∫...">

        <div class="form-check">
          <input class="form-check-input note-check" type="checkbox" value="√çt ng·ªçt" id="note1">
          <label class="form-check-label" for="note1">√çt ng·ªçt</label>
        </div>
        <div class="form-check">
          <input class="form-check-input note-check" type="checkbox" value="Kh√¥ng ƒë√°" id="note2">
          <label class="form-check-label" for="note2">Kh√¥ng ƒë√°</label>
        </div>
        <div class="form-check">
          <input class="form-check-input note-check" type="checkbox" value="Nhi·ªÅu cafe" id="note3">
          <label class="form-check-label" for="note3">Nhi·ªÅu cafe</label>
        </div>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
        <button type="button" class="btn btn-success" id="saveNoteBtn" data-bs-dismiss="modal">L∆∞u ghi ch√∫</button>
      </div>
    </div>
  </div>
</div>

<!-- Offcanvas gi·ªè h√†ng -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="cartCanvas">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title">üõí Gi·ªè h√†ng</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
  </div>
  <div class="offcanvas-body" id="cartItems">
    <p class="text-muted">Ch∆∞a c√≥ m√≥n n√†o</p>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
let cart = JSON.parse(localStorage.getItem('cart')) || {items: []};
renderCart();

// TƒÉng gi·∫£m s·ªë l∆∞·ª£ng
document.querySelectorAll('.btn-plus').forEach(btn => {
  btn.addEventListener('click', () => {
    let input = btn.closest('.qty-box').querySelector('.qty-input');
    input.value = parseInt(input.value) + 1;
  });
});
document.querySelectorAll('.btn-minus').forEach(btn => {
  btn.addEventListener('click', () => {
    let input = btn.closest('.qty-box').querySelector('.qty-input');
    if (parseInt(input.value) > 0) {
      input.value = parseInt(input.value) - 1;
    }
  });
});

// Ghi ch√∫ modal
const noteModal = document.getElementById('noteModal');
noteModal.addEventListener('show.bs.modal', function (event) {
  const button = event.relatedTarget;
  const productId = button.getAttribute('data-id');
  document.getElementById('currentProductId').value = productId;
  document.getElementById('nameInput').value = '';
  document.getElementById('noteInput').value = '';
  document.querySelectorAll('.note-check').forEach(c => c.checked = false);
});

// Checkbox update text
const noteInput = document.getElementById('noteInput');
document.querySelectorAll('.note-check').forEach(chk => {
  chk.addEventListener('change', () => {
    let selected = [];
    document.querySelectorAll('.note-check:checked').forEach(c => selected.push(c.value));
    noteInput.value = selected.join(', ');
  });
});

// L∆∞u ghi ch√∫ t·∫°m
document.getElementById('saveNoteBtn').addEventListener('click', () => {
  const productId = document.getElementById('currentProductId').value;
  const displayTarget = document.getElementById('note-display-' + productId);
  let name = document.getElementById('nameInput').value.trim();
  let note = noteInput.value.trim();
  let displayText = '';
  if (name) displayText += 'Ng∆∞·ªùi: ' + name;
  if (note) displayText += (name ? ' | ' : '') + 'Ghi ch√∫: ' + note;
  displayTarget.textContent = displayText;
});

// Th√™m v√†o gi·ªè
document.querySelectorAll('.btn-addcart').forEach(btn => {
  btn.addEventListener('click', () => {
    let card = btn.closest('.card-body');
    let qty = parseInt(card.querySelector('.qty-input').value);
    if (qty <= 0) {
      alert("Vui l√≤ng ch·ªçn s·ªë l∆∞·ª£ng > 0");
      return;
    }
    let id = btn.dataset.id;
    let name = btn.dataset.name;
    let price = parseInt(btn.dataset.price);
    let noteText = document.getElementById('note-display-' + id).textContent;

    cart.items.push({id, name, qty, price, note: noteText});
    localStorage.setItem('cart', JSON.stringify(cart));
    renderCart();
    card.querySelector('.qty-input').value = 0;
  });
});

// Render gi·ªè
function renderCart() {
  const cartItems = document.getElementById('cartItems');
  if (cart.items.length === 0) {
    cartItems.innerHTML = '<p class="text-muted">Ch∆∞a c√≥ m√≥n n√†o</p>';
  } else {
    cartItems.innerHTML = cart.items.map((item, i) =>
      `<div class="border-bottom py-2">
         <strong>${item.name}</strong> x${item.qty} - ${item.price * item.qty}ƒë
         <br><small>${item.note}</small>
       </div>`
    ).join('');
  }
  document.getElementById('cartCount').textContent = cart.items.length;
}
</script>

</body>
</html>
